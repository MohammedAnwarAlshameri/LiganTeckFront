<!-- Language / Locale switcher -->
<header class="langbar" aria-label="language switcher">
  <div class="lang-switch" (click)="toggleLanguageMenu()" [attr.aria-expanded]="isLanguageMenuOpen">
    <div class="globe" aria-hidden="true">🌐</div>
    <span>{{ currentLanguage === 'ar' ? 'Ar' : 'En' }}</span>
    <span class="caret">▾</span>
  </div>
  <div class="lang-menu" [hidden]="!isLanguageMenuOpen" role="menu">
    <button (click)="changeLanguage('ar')" role="menuitem">Arabic</button>
    <button (click)="changeLanguage('en')" role="menuitem">English</button>
  </div>
</header>

<main class="split" id="app">
  <!-- Left: Login form -->
  <section class="pane left">
    <form class="card" [formGroup]="loginForm" (ngSubmit)="onSubmit()" novalidate>
      <h2 class="title">{{ currentLanguage === 'ar' ? 'تسجيل الدخول' : 'Sign In' }}</h2>
      <p class="subtitle muted" [innerHTML]="currentLanguage === 'ar' ? 'قم بتسجيل الدخول إلى <b>Lijan Teck</b>.' : 'Sign in to <b>Lijan Teck</b>.'"></p>

      <!-- Toggle للتبديل بين Admin و Customer -->
      <div class="login-mode-toggle">
        <button 
          type="button" 
          [class.active]="!isAdminMode" 
          (click)="isAdminMode = false; error = ''"
          class="mode-btn"
        >
          <i class="mdi mdi-account"></i>
          {{ currentLanguage === 'ar' ? 'عميل' : 'Customer' }}
        </button>
        <button 
          type="button" 
          [class.active]="isAdminMode" 
          (click)="isAdminMode = true; error = ''"
          class="mode-btn"
        >
          <i class="mdi mdi-shield-account"></i>
          {{ currentLanguage === 'ar' ? 'مدير' : 'Admin' }}
        </button>
      </div>

      <div class="field">
        <label for="username">{{ currentLanguage === 'ar' ? 'تسجيل الدخول' : 'Login' }}</label>
        <input 
          id="username" 
          name="username" 
          class="inp" 
          type="text" 
          formControlName="email"
          [placeholder]="currentLanguage === 'ar' ? 'Username' : 'Username'" 
          autocomplete="username" 
          [ngClass]="{ 'is-invalid': submitted && f['email'].errors }"
        />
        @if (submitted && f['email'].errors) {
          <div class="error">
            {{ currentLanguage === 'ar' ? 'اسم المستخدم مطلوب' : 'Username is required' }}
          </div>
        }
      </div>

      <div class="field">
        <label for="password">{{ currentLanguage === 'ar' ? 'كلمة المرور' : 'Password' }}</label>
      
        <!-- مجموعة الإدخال مع زر العين داخل الحقل -->
        <div class="auth-pass-inputgroup">
          <input
            id="password"
            name="password"
            class="inp"
            [type]="fieldTextType ? 'text' : 'password'"
            formControlName="password"
            [placeholder]="currentLanguage === 'ar' ? 'Password' : 'Password'"
            autocomplete="current-password"
            [ngClass]="{ 'is-invalid': submitted && f['password'].errors }"
          />
        </div>
      
        @if (submitted && f['password'].errors) {
          <div class="error">
            {{ currentLanguage === 'ar' ? 'كلمة المرور مطلوبة' : 'Password is required' }}
          </div>
        }
      </div>
      
      <div class="actions">
        <button class="btn" type="submit" [disabled]="loading">
          {{ loading ? (currentLanguage === 'ar' ? 'جاري التحميل...' : 'Loading...') : (currentLanguage === 'ar' ? 'تسجيل الدخول' : 'Sign In') }}
        </button>

        <div class="helper">
          <label>
            <input type="checkbox" id="remember" formControlName="remember" />
            <span class="muted">{{ currentLanguage === 'ar' ? 'تذكرني' : 'Remember me' }}</span>
          </label>
          <span style="flex:1"></span>
          <a routerLink="/auth/pass-reset" class="muted">
            {{ currentLanguage === 'ar' ? 'نسيت كلمة المرور؟' : 'Forgot password?' }}
          </a>
        </div>
        
        <div class="cta-inline muted">
          <span>{{ currentLanguage === 'ar' ? 'لا تمتلك حساباً؟' : "Don't have an account?" }}</span>
          <a routerLink="/auth/register">{{ currentLanguage === 'ar' ? 'أنشئ حساباً جديداً' : 'Create a new account' }}</a>
        </div>
                
        @if (error) {
          <div class="error" aria-live="polite">{{ error }}</div>
        }
      </div>
    </form>

    <footer>
      <div class="foot">
        © {{ year }} <strong>Logix</strong> — 
        {{ currentLanguage === 'ar' ? 'جميع الحقوق محفوظة. لوجكس ولجان تك علامات تجارية.' : 'All rights reserved. Logix and Lijan Teck are trademarks.' }}
      </div>
    </footer>
  </section>

  <!-- Right: Logo / brand panel -->
  <aside class="pane right">
    <div class="brand" aria-label="Logix – Lijan Teck brand">
      <div class="logo" aria-hidden="true">LJ</div>
      <h1>Lijan Teck</h1>
      <div class="tag">Logix</div>
    </div>
  </aside>
</main>