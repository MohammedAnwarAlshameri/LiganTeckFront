<!-- Language / Locale switcher -->
<header class="langbar" aria-label="language switcher">
  <div class="lang-switch" (click)="toggleLanguageMenu()" [attr.aria-expanded]="isLanguageMenuOpen">
    <div class="globe" aria-hidden="true">🌐</div>
    <span>{{ currentLanguage === 'ar' ? 'Ar' : 'En' }}</span>
    <span class="caret">▾</span>
  </div>
  <div class="lang-menu" [hidden]="!isLanguageMenuOpen" role="menu">
    <button (click)="changeLanguage('ar')" role="menuitem">Arabic</button>
    <button (click)="changeLanguage('en')" role="menuitem">English</button>
  </div>
</header>

<main class="split" id="app">
  <!-- Right: Logo / brand panel -->
  <aside class="pane right">
    <div class="brand" aria-label="Logix – Lijan Teck brand">
      <div class="logo" aria-hidden="true">LJ</div>
      <h1>Lijan Teck</h1>
      <div class="tag">Logix</div>
    </div>
  </aside>

  <!-- Left: Registration form -->
  <section class="pane left">
    <form class="card" [formGroup]="signupForm" (ngSubmit)="onSubmit()" novalidate>
      <h2 class="title">{{ currentLanguage === 'ar' ? 'إنشاء حساب جديد' : 'Create New Account' }}</h2>
      <p class="subtitle muted" [innerHTML]="currentLanguage === 'ar' ? 'أكمل بياناتك لإنشاء حسابك على <b>Lijan Teck</b>.' : 'Complete your data to create your account on <b>Lijan Teck</b>.'"></p>

      <!-- Row 1: Full Name & Company Name -->
      <div class="field-row">
        <div class="field">
          <label for="fullName">{{ currentLanguage === 'ar' ? 'الاسم الكامل' : 'Full Name' }}</label>
          <input 
            id="fullName" 
            name="fullName" 
            class="inp" 
            type="text" 
            formControlName="fullName"
            [placeholder]="currentLanguage === 'ar' ? 'أدخل اسمك كما سيظهر في الفواتير.' : 'Enter your name as it will appear on invoices.'" 
            autocomplete="name" 
            [ngClass]="{ 'is-invalid': submitted && f['fullName'].errors }"
          />
          @if (submitted && f['fullName'].errors) {
            <div class="error">
              {{ currentLanguage === 'ar' ? 'الاسم الكامل مطلوب' : 'Full name is required' }}
            </div>
          }
        </div>

        <div class="field">
          <label for="companyName">{{ currentLanguage === 'ar' ? 'اسم الشركة' : 'Company Name' }}</label>
          <input 
            id="companyName" 
            name="companyName" 
            class="inp" 
            type="text" 
            formControlName="companyName"
            [placeholder]="currentLanguage === 'ar' ? 'أدخل اسم الشركة' : 'Enter company name'" 
            autocomplete="organization" 
            [ngClass]="{ 'is-invalid': submitted && f['companyName'].errors }"
          />
          @if (submitted && f['companyName'].errors) {
            <div class="error">
              {{ currentLanguage === 'ar' ? 'اسم الشركة مطلوب' : 'Company name is required' }}
            </div>
          }
        </div>
      </div>

      <!-- Row 2: Email & Country -->
      <div class="field-row">
        <div class="field">
          <label for="email">{{ currentLanguage === 'ar' ? 'البريد الإلكتروني' : 'Email Address' }}</label>
          <input 
            id="email" 
            name="email" 
            class="inp" 
            type="email" 
            formControlName="email"
            [placeholder]="currentLanguage === 'ar' ? 'أدخل البريد الإلكتروني' : 'Enter email address'" 
            autocomplete="email" 
            [ngClass]="{ 'is-invalid': submitted && f['email'].errors }"
          />
          @if (submitted && f['email'].errors) {
            <div class="error">
              {{ currentLanguage === 'ar' ? 'البريد الإلكتروني مطلوب' : 'Email address is required' }}
            </div>
          }
        </div>

        <div class="field">
          <label for="country">{{ currentLanguage === 'ar' ? 'الدولة' : 'Country' }}</label>
          <select 
            id="country" 
            name="country" 
            class="inp" 
            formControlName="country"
            [ngClass]="{ 'is-invalid': submitted && f['country'].errors }"
          >
            <option value="">{{ currentLanguage === 'ar' ? 'اختر الدولة' : 'Choose Country' }}</option>
            <option value="SA">السعودية</option>
            <option value="AE">الإمارات العربية المتحدة</option>
            <option value="KW">الكويت</option>
            <option value="QA">قطر</option>
            <option value="BH">البحرين</option>
            <option value="OM">عمان</option>
            <option value="JO">الأردن</option>
            <option value="LB">لبنان</option>
            <option value="EG">مصر</option>
            <option value="MA">المغرب</option>
            <option value="TN">تونس</option>
            <option value="DZ">الجزائر</option>
          </select>
          @if (submitted && f['country'].errors) {
            <div class="error">
              {{ currentLanguage === 'ar' ? 'الدولة مطلوبة' : 'Country is required' }}
            </div>
          }
        </div>
      </div>

      <!-- Row 3: Phone & Username -->
      <div class="field-row">
        <div class="field">
          <label for="phone">{{ currentLanguage === 'ar' ? 'رقم الهاتف' : 'Phone Number' }}</label>
          <input 
            id="phone" 
            name="phone" 
            class="inp" 
            type="tel" 
            formControlName="phone"
            [placeholder]="currentLanguage === 'ar' ? '+9665XXXXXXXX' : '+9665XXXXXXXX'" 
            autocomplete="tel" 
            [ngClass]="{ 'is-invalid': submitted && f['phone'].errors }"
          />
          <div class="helper-text">
            {{ currentLanguage === 'ar' ? 'أدخل رقم هاتف صالح بصيغة دولية.' : 'Enter a valid phone number in international format.' }}
          </div>
          @if (submitted && f['phone'].errors) {
            <div class="error">
              {{ currentLanguage === 'ar' ? 'رقم الهاتف مطلوب' : 'Phone number is required' }}
            </div>
          }
        </div>

        <div class="field">
          <label for="username">{{ currentLanguage === 'ar' ? 'اسم المستخدم' : 'Username' }}</label>
          <input 
            id="username" 
            name="username" 
            class="inp" 
            type="text" 
            formControlName="username"
            [placeholder]="currentLanguage === 'ar' ? 'أدخل اسم المستخدم' : 'Enter username'" 
            autocomplete="username" 
            [ngClass]="{ 'is-invalid': submitted && f['username'].errors }"
          />
          <div class="helper-text">
            {{ currentLanguage === 'ar' ? '٤-٣٠ حرفاً، بدون مسافات.' : '4-30 characters, no spaces.' }}
          </div>
          @if (submitted && f['username'].errors) {
            <div class="error">
              {{ currentLanguage === 'ar' ? 'اسم المستخدم مطلوب' : 'Username is required' }}
            </div>
          }
        </div>
      </div>

      <!-- Row 4: Password & Confirm Password -->
      <div class="field-row">
        <div class="field">
          <label for="password">{{ currentLanguage === 'ar' ? 'كلمة المرور' : 'Password' }}</label>
          <div class="auth-pass-inputgroup">
            <input 
              id="password" 
              name="password" 
              class="inp" 
              [type]="fieldTextType ? 'text' : 'password'" 
              formControlName="password"
              [placeholder]="currentLanguage === 'ar' ? 'أدخل كلمة المرور' : 'Enter password'" 
              autocomplete="new-password" 
              [ngClass]="{ 'is-invalid': submitted && f['password'].errors }"
            />
          </div>
          
          @if (submitted && f['password'].errors) {
            <div class="error">
              {{ currentLanguage === 'ar' ? 'كلمة المرور غير صالحة' : 'Password is required' }}
            </div>
          }
        </div>
  
        <div class="field">
          <label for="confirmPassword">{{ currentLanguage === 'ar' ? 'تأكيد كلمة المرور' : 'Confirm Password' }}</label>
          <div class="auth-pass-inputgroup">
            <input 
              id="confirmPassword" 
              name="confirmPassword" 
              class="inp" 
              [type]="confirmFieldTextType ? 'text' : 'password'" 
              formControlName="confirmPassword"
              [placeholder]="currentLanguage === 'ar' ? 'أعد إدخال كلمة المرور' : 'Re-enter password'" 
              autocomplete="new-password" 
              [ngClass]="{ 'is-invalid': submitted && f['confirmPassword'].errors }"
            />
          </div>
          
          @if (submitted && f['confirmPassword'].errors) {
            <div class="error">
              {{ currentLanguage === 'ar' ? 'تأكيد كلمة المرور مطلوب' : 'Password confirmation is required' }}
            </div>
          }
        </div>
        <div class="field">
          <div class="helper-text">
            {{ currentLanguage === 'ar' ? '٨ أحرف، حرف كبير/صغير، رقم، رمز' : '8 characters, uppercase/lowercase letter, number, symbol' }}
          </div>
        </div>
      </div>

      <div class="field">
        <div class="helper">
          <label>
            <input type="checkbox" id="terms" formControlName="terms" />
            <span class="muted">
              {{ currentLanguage === 'ar' ? 'أوافق على' : 'I agree to' }}
              <a href="#" class="accent-link">{{ currentLanguage === 'ar' ? 'الشروط والخصوصية' : 'Terms and Privacy' }}</a>
            </span>
          </label>
        </div>
        @if (submitted && f['terms'].errors) {
          <div class="error">
            {{ currentLanguage === 'ar' ? 'يجب الموافقة على الشروط والأحكام' : 'You must agree to the terms and conditions' }}
          </div>
        }
      </div>

      <div class="actions">
        <button class="btn" type="submit" [disabled]="loading">
          {{ loading ? (currentLanguage === 'ar' ? 'جاري إنشاء الحساب...' : 'Creating Account...') : (currentLanguage === 'ar' ? 'إنشاء الحساب' : 'Create Account') }}
        </button>
        
        <button type="button" class="btn btn-outline" (click)="goToLogin()">
          {{ currentLanguage === 'ar' ? 'تسجيل الدخول' : 'Login' }}
        </button>
        
        @if (error) {
          <div class="error" aria-live="polite">{{ error }}</div>
        }
      </div>
    </form>

    <footer>
      <div class="foot">
        © {{ year }} <strong>Logix</strong> — 
        {{ currentLanguage === 'ar' ? 'جميع الحقوق محفوظة. لوجكس ولجان تك علامات تجارية.' : 'All rights reserved. Logix and Lijan Teck are trademarks.' }}
      </div>
    </footer>
  </section>
</main>